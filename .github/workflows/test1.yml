name: Use Environment Variable

on:
  workflow_run:
    workflows: [ "Set Environment Variable" ]
    types:
      - completed

jobs:
  use-env-var:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Extract version from PR
        id: get_version
        run: |
          LATEST_VERSION=$(echo "${{ github.event.pull_request.title }}" | grep -oP '(?<=Release )[0-9]+\.[0-9]+\.[0-9]+(-pre-alpha|-alpha|-beta)?')
          if [[ ! $LATEST_VERSION ]]; then
            echo "Version info not found."
            exit 1
          fi
          echo "LATEST_VERSION=$LATEST_VERSION" >> $GITHUB_ENV
